\input{./mac/head.tex}
\input{./mac/maths.tex}

\Bdc{Notes on Mathematical Analysis}

\section{The Calculus of Variations}

\subsection{Linear Forms}

Let \(F\) be a field, and let \(V\) be a vector space over \(F\). A linear map from \(V\) into \(F\) is referred to as a
\emph{linear form on \(V\)}. Equivalently, a function \(\map{f}{V}{F}\) is a linear form if \(f(\lambda \vct{a}
+ \vct{b}) = \lambda f(\vct{a}) + f(\vct{b})\) for any \(\lambda \in F\) and any \(\vct{a}, \vct{b} \in V\). Linear
forms are also known as \emph{linear functionals}.

Let \([x_0, x_1]\) be a closed interval on \(\setreal\), and let \(C^0\big([x_0, x_1]\big)\) be the vector space of
continuous real functions on \([x_0, x_1]\). Then \(\map{J}{C^0\big([x_0, x_1]\big)}{\setreal}\) defined by
\[
  J(f) = \int_{x_0}^{x_1} f(x) \diff x
\]
is a linear form on \(C^0\big([x_0, x_1]\big)\).

\subsection{Functionals and Their Extrema}

Let \([x_0, x_1]\) be a closed interval on \(\setreal\), and let \(C^2\big([x_0, x_1]\big)\) be the set of twice
continuously differentiable real functions on \([x_0, x_1]\). We refer to linear forms on \(C^2\big([x_0, x_1]\big)\) as
\emph{functionals}. We denote a functional by enclosing its variable in square brackets.

Let \(\Omega \subseteq C^2\big([x_0, x_1]\big)\) be a set of functions. A functional \(\map{J}{\Omega}{\setreal}\) is
said to obtain an \emph{extremum at function \(f\)} if there exists an \(\varepsilon \in \posreal\) such that \(J[g]
- J[f]\) has the same sign for any \(g \in \Omega\) which satisfies \(\forall x \in [x_0, x_1] \, \big(\abs{g(x) - f(x)}
< \varepsilon\big)\).

\subsection{Vanishing of the First Variation}
\label{subsec01}

Let \(\Omega \subset C^2\big([x_0, x_1]\big)\) be given by \(\Omega = \set*{f \in C^2\big([x_0, x_1]\big) : y_0 = f(x_0)
\, \land \, y_1 = f(x_1)}\) wherein \(y_0, y_1 \in \setreal\) are prescribed. Consider a functional of the form
\begin{align}
  \label{eq0}
  J[f] = \int_{x_0}^{x_1} L\big(x, f'(x), f(x)\big) \diff x
\end{align}
wherein \(L\) is a twice continuously differentiable function with respect to \(x\), \(f'\), and \(f\).

Suppose \(f \in \Omega\) is a function whereat the functional \(J\) obtains an extremum. Take another function
\(\eta \in C^2\big([x_0, x_1]\big)\) which vanishes at \(x_0\) and \(x_1\). We then form the family of functions
\[
  \varphi(x, \varepsilon) = f(x) + \varepsilon \eta(x)
\]
with \(\varepsilon \in \setreal\). Note that with any given \(\varepsilon\) we have \(\varphi \in \Omega\).

We see that
\[
  \eta(x) = \frac{\partial \varphi}{\partial \varepsilon},
\]
and so we refer to \(\varepsilon \eta(x)\) as a \emph{variation of \(f\)} and denote it by \(\updelta f\).

Let \(\psi(\varepsilon) = J[f + \varepsilon \eta]\) be a real function. The postulate that \(f\) shall give an extremum
of \(J\) implies that \(\psi\) shall possess an extremum for \(\varepsilon = 0\), and so it is necessary that
\[
  \psi'(0) = 0.
\]
If \(f\) satisfies \(\psi'(0) = 0\) for any \(\eta\), we then say that \(J\) is \emph{stationary at \(f\)}.

In general, we refer to \(\varepsilon \psi'(0)\) as the \emph{first variation of \(J\)} and denote it by \(\updelta J\).
Thus, the stationary character of \(J\) at \(f\) is equivalent to the vanishing of the first variation.

\subsection{The Fundamental Lemma of the Calculus of Variations}

\Blm[fundamental lemma of the calculus of variations]
  \label{lm01}
  If a function \(f \in C^0\big([x_0, x_1]\big)\) satisfies
  \[
    \int_{x_0}^{x_1} \eta(x) f(x) \diff x = 0
  \]
  for any \(\eta \in C^2\big([x_0, x_1]\big)\) such that \(\eta(x_0) = \eta(x_1) = 0\), then \(f(x) = 0\) for any
  \(x \in [x_0, x_1]\).
\Elm
\Bpr
  We assume, for the sake of contradiction, that there exists a \(\xi \in [x_0, x_1]\) such that \(f(\xi) > 0\) and
  which satisfies all the prescribed conditions. Then, as \(f\) is continuous on \([x_0, x_1]\), there exists an
  \(\alpha \in \posreal\) such that \(f(x) > 0\) for any \(x \in [\xi - \alpha, \xi + \alpha] \subseteq [x_0, x_1]\).
  Let \(\eta \in C^2\big([x_0, x_1]\big)\) be defined by
  \[
    \eta(x) = \begin{cases}
      \big((x - \xi)^2 - \alpha^2\big)^4 & \text{if } x \in [\xi - \alpha, \xi + \alpha],\\
      0 & \text{otherwise}.
    \end{cases}
  \]
  We see that \(\eta(x) f(x) > 0\) for any \(x \in [\xi - \alpha, \xi + \alpha]\) and that \(\eta(x) f(x) = 0\) for any
  \(x \in [x_0, \xi - \alpha) \cup (\xi + \alpha, x_1]\). It follows that
  \[
    \int_{x_0}^{x_1} \eta(x) f(x) \diff x > 0,
  \]
  which is a contradiction. Therefore, \(f(\xi)\) cannot be positive. For the same reasons, \(f(\xi)\) cannot be
  negative. Hence, \(f(x)\) must vanish for any \(x \in [x_0, x_1]\).

  Thus, the lemma holds.
\Epr

\subsection{The Euler--Lagrange Equation}

\Bth[Euler--Lagrange]
  The functional \(J\) defined in \autoref{eq0} is stationary at function \(f\) if and only if
  \[
    \frac{\partial L}{\partial f}\big(x, f(x), f'(x)\big) - \frac{\diff}{\diff x} \frac{\partial L}{\partial f'}\big(x,
    f(x), f'(x)\big) = 0
  \]
  for any \(x \in [x_0, x_1]\).
\Eth
\Bpr
  As shown in \autoref{subsec01}, that \(J\) is stationary at \(f\) is equivalent to the vanishing of
  {\allowdisplaybreaks
    \begin{align*}
      \left.\frac{\diff \psi}{\diff \varepsilon}(\varepsilon)\right|_{\varepsilon = 0}
      = & \left.\frac{\diff}{\diff \varepsilon} \int_{x_0}^{x_1} J\big[f(x) + \varepsilon \eta(x)\big]
      \diff x\right|_{\varepsilon = 0}\\
      = & \left.\frac{\diff}{\diff \varepsilon} \int_{x_0}^{x_1} L\big(x, f(x) + \varepsilon \eta(x), f'(x) + \varepsilon
      \eta'(x)\big) \diff x\right|_{\varepsilon = 0}\\
      = & \int_{x_0}^{x_1} \left.\frac{\partial}{\partial \varepsilon} L\big(x, f(x) + \varepsilon \eta(x), f'(x)
      + \varepsilon \eta'(x)\big)\right|_{\varepsilon = 0} \diff x\\
      = & \int_{x_0}^{x_1} \left(\left.\frac{\partial}{\partial \varepsilon}\big(f(x) + \varepsilon
      \eta(x)\big)\right|_{\varepsilon = 0} \left.\frac{\partial L}{\partial (f + \varepsilon \eta)}\big(x, f(x)
      + \varepsilon \eta(x), f'(x) + \varepsilon \eta'(x)\big)\right|_{\varepsilon = 0}\right.\\
      & + \left.\left.\frac{\partial}{\partial \varepsilon} \big(f'(x) + \varepsilon \eta'(x)\big)\right|_{\varepsilon
      = 0} \left.\frac{\partial L}{\partial (f' + \varepsilon \eta')}\big(x, f(x) + \varepsilon \eta(x), f'(x)
      + \varepsilon \eta'(x)\big)\right|_{\varepsilon = 0}\right) \diff x\\
      = & \int_{x_0}^{x_1} \left(\eta(x) \frac{\partial L}{\partial f}\big(x, f(x), f'(x)\big) + \eta'(x)
      \frac{\partial L}{\partial f'}\big(x, f(x), f'(x)\big)\right) \diff x.
    \end{align*}
  }
  We further see that
  \begin{align*}
    \int_{x_0}^{x_1} \eta'(x) \frac{\partial L}{\partial f'}\big(x, f(x), f'(x)\big) \diff x = & \left.\eta(x)
    \frac{\partial L}{\partial f'}\big(x, f(x), f'(x)\big)\right|_{x_0}^{x_1}\\
    & - \int_{x_0}^{x_1} \eta(x) \diff \frac{\partial L}{\partial f'}\big(x, f(x), f'(x)\big)\\
    = & - \int_{x_0}^{x_1} \eta(x) \frac{\diff}{\diff x} \frac{\partial L}{\partial f'}\big(x, f(x), f'(x)\big) \diff x.
  \end{align*}
  By integration by parts, the equivalent condition is then
  \[
    \int_{x_0}^{x_1} \eta(x) \left(\frac{\partial L}{\partial f}\big(x, f(x), f'(x)\big) - \frac{\diff}{\diff x}
    \frac{\partial L}{\partial f'}\big(x, f(x), f'(x)\big)\right) \diff x = 0.
  \]
  By \autoref{lm01}, we then conclude that
  \[
    \frac{\partial L}{\partial f}\big(x, f(x), f'(x)\big) - \frac{\diff}{\diff x} \frac{\partial L}{\partial f'}\big(x,
    f(x), f'(x)\big) = 0
  \]
  for any \(x \in [x_0, x_1]\).

  Hence, the theorem holds.
\Epr

\Edc
